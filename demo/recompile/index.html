<html>
<script type=module>
import { create } from "@paulkinlan/f";
import { prompt, ChromePromptConfiguration } from "@paulkinlan/reactive-prompt/chrome";
import { signal, effect } from "@preact/signals";

const f = create(
  prompt, new ChromePromptConfiguration()
);

const numbers = signal(2);

// Prompts can take a signal as an argument which means the prompt can re-run.
const sum = await f`Sum ${numbers} numbers`;

// The first generated function is the direct invocation of the code generated by the prompt. While it can update, you won't know if it did.
console.log("Direct invocation", sum(22,44));

// Update the signal which will re-generate the function.
setTimeout(() => {
  numbers.value = 3;
}, 2000);

// Watch for changes.
effect(()=>{
  // Each function has a signal that you can watch.
  const func = sum.signal.value;
  // You can either call sum directly, or you can do it via the signal.
  if (func) {
    if (func.length === 2) {
      console.log(func(22, 44));
    } else if (func.length === 3) {
      console.log(func(1,2, 3));
    }
  }
})

</script>


</html>